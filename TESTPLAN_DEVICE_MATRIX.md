# Device Test Matrix

> DreamSync Release Hardening — 디바이스 테스트 매트릭스 (2026-02-04)

## 1. 디바이스/OS 조합

### iOS

| 디바이스 | iOS 버전 | 화면 | 우선순위 |
|----------|----------|------|---------|
| iPhone 15 Pro | iOS 18.x | 6.1" | P0 |
| iPhone SE 3 | iOS 17.x | 4.7" | P0 |
| iPad Air (M2) | iPadOS 18.x | 10.9" | P2 |

### Android

| 디바이스 | Android 버전 | 화면 | 우선순위 |
|----------|-------------|------|---------|
| Pixel 8 | Android 15 | 6.2" | P0 |
| Samsung Galaxy S23 | Android 14 | 6.1" | P0 |
| Samsung Galaxy A14 | Android 13 | 6.6" (저사양) | P1 |
| Xiaomi Redmi Note 12 | Android 13 | 6.67" | P2 |

### Web (PWA)

| 브라우저 | 버전 | 우선순위 |
|----------|------|---------|
| Chrome (Desktop) | 최신 | P0 |
| Safari (Desktop) | 최신 | P0 |
| Chrome (Mobile) | 최신 | P1 |
| Safari (iOS) | 최신 | P1 |
| Firefox (Desktop) | 최신 | P2 |

---

## 2. 테스트 시나리오

### A. 핵심 플로우 (P0 — 모든 디바이스 필수)

| # | 시나리오 | 단계 | 기대 결과 | Pass/Fail |
|---|---------|------|----------|-----------|
| A1 | 게스트 로그인 → 대시보드 | 1. 앱 열기 → 2. "게스트로 시작" 탭 → 3. 대시보드 확인 | 인사말 + 퀵액션 표시 | |
| A2 | 꿈 기록 → AI 분석 | 1. 대시보드 → 2. "꿈 기록" 탭 → 3. 텍스트 50자+ 입력 → 4. "기록하기" → 5. 분석 결과 확인 | 분석 카드에 감정/심볼/해석 표시, 스키마 통과 | |
| A3 | 체크인 4단계 완료 | 1. 대시보드 → 2. "체크인" 탭 → 3. 컨디션 선택 → 4. 감정 선택 → 5. 스트레스 입력 → 6. 이벤트 선택 → 7. 완료 | 4단계 모두 진행, 완료 토스트, 대시보드 반영 | |
| A4 | 주간 리포트 확인 | 1. 체크인 3일+ 후 → 2. "리포트" 탭 → 3. 차트/패턴/인사이트 확인 | 데이터 있으면 차트 표시, 없으면 빈 상태 메시지 | |
| A5 | 설정 → 기능 토글 | 1. 설정 → 2. Feature Flags 섹션 → 3. 토글 on/off → 4. 앱 재시작 | 플래그 값 persist, 해당 UI 표시/숨김 | |

### B. 권한 시나리오 (P0 — iOS/Android만)

| # | 시나리오 | 전제조건 | 단계 | 기대 결과 |
|---|---------|---------|------|----------|
| B1 | HealthKit 권한 허용 | iOS, healthkit=true | 1. 설정 → 건강 앱 연동 → 2. "연동하기" → 3. 시스템 권한 대화상자에서 "허용" | 수면 데이터 동기화, 체크인에 수면 단계 표시 |
| B2 | HealthKit 권한 거부 | iOS, healthkit=true | 1. 설정 → 건강 앱 연동 → 2. "연동하기" → 3. 시스템 권한 대화상자에서 "허용 안 함" | 수동 입력 폴백, 에러 토스트 없음, graceful 메시지 |
| B3 | HealthKit 권한 해제 후 재시도 | iOS, healthkit=true, 이전에 허용 | 1. iOS 설정에서 HealthKit 권한 해제 → 2. 앱 복귀 → 3. 수면 동기화 시도 | 권한 해제 감지, "설정에서 재활성화" 안내, crash 없음 |
| B4 | Health Connect 권한 허용 | Android, healthkit=true | 1. 설정 → 건강 앱 연동 → 2. "연동하기" → 3. Health Connect 권한 허용 | 수면 데이터 동기화 |
| B5 | Health Connect 미설치 | Android, healthkit=true | 1. Health Connect 앱 미설치 상태 → 2. "연동하기" 탭 | "Health Connect 설치 필요" 안내, Play Store 링크 |
| B6 | 알림 권한 거부 | iOS/Android | 1. 설정 → 알림 → 2. 시스템 권한 거부 | 앱 내 알림 설정 비활성화, crash 없음 |

### C. 네트워크 시나리오 (P0)

| # | 시나리오 | 단계 | 기대 결과 |
|---|---------|------|----------|
| C1 | 오프라인에서 꿈 기록 | 1. 비행기 모드 → 2. 꿈 텍스트 입력 → 3. "기록하기" | 로컬 저장 성공, OfflineBanner 표시, syncQueue에 enqueue |
| C2 | 오프라인→온라인 전환 | 1. C1 후 → 2. 비행기 모드 해제 | OfflineBanner 제거, syncQueue flush, 데이터 동기화 |
| C3 | 체크인 중 연결 끊김 | 1. 체크인 3단계 진행 중 → 2. WiFi 끊기 | 진행 상태 유지, 완료 시 로컬 저장 |
| C4 | 느린 네트워크 (3G) | 1. Chrome DevTools 3G throttle → 2. AI 분석 요청 | 로딩 표시, 타임아웃 시 graceful 에러 |
| C5 | 간헐적 연결 | 1. 10초 on/off 반복 → 2. 앱 정상 사용 | 데이터 유실 0, UI 깜빡임 최소 |

### D. 앱 생명주기 (P1 — 네이티브만)

| # | 시나리오 | 단계 | 기대 결과 |
|---|---------|------|----------|
| D1 | 백그라운드→복귀 (1분) | 1. 꿈 입력 중 → 2. 홈 버튼 → 3. 1분 후 복귀 | 텍스트 유지, 상태 정합 |
| D2 | 백그라운드→복귀 (30분) | 1. 체크인 2단계 → 2. 홈 → 3. 30분 후 복귀 | 진행 상태 유지 or graceful 재시작 |
| D3 | 앱 강제 종료→재시작 | 1. 데이터 입력 중 → 2. 앱 강제 종료 → 3. 재실행 | persist된 데이터 복원, 미저장 입력은 유실 허용 |
| D4 | 날짜 전환 (자정) | 1. 23:59에 앱 사용 → 2. 00:01까지 대기 | 대시보드 인사말 업데이트, 날짜 필터 정상 |
| D5 | 시스템 로케일 변경 | 1. 기기 언어 영어→한국어 → 2. 앱 복귀 | crash 없음, 날짜 포맷 정상 |

### E. UI/접근성 (P1)

| # | 시나리오 | 단계 | 기대 결과 |
|---|---------|------|----------|
| E1 | 다크 모드 전환 | 1. 시스템 다크 모드 → 2. 모든 페이지 확인 | 대비 충분, 텍스트 가독성 양호 |
| E2 | 큰 텍스트 (접근성) | 1. 시스템 글자 크기 최대 → 2. 전체 화면 확인 | 잘림 없음, 스크롤 가능 |
| E3 | 가로 모드 | 1. 기기 회전 → 2. 주요 화면 확인 | 레이아웃 깨짐 없음 (최소 수준) |
| E4 | VoiceOver/TalkBack | 1. 스크린 리더 활성화 → 2. 핵심 플로우 탐색 | aria-label 읽힘, 포커스 순서 논리적 |
| E5 | 키보드 overlap | 1. 텍스트 입력 필드 탭 → 2. 키보드 표시 | 입력 필드 가려지지 않음, 스크롤 가능 |

---

## 3. 실행 가이드

### 테스트 환경 준비

```bash
# Web (로컬)
npm run dev

# iOS (시뮬레이터)
npm run cap:ios

# Android (에뮬레이터)
npm run cap:android
```

### 테스트 기록 방법

1. 각 시나리오 실행 전 기기/OS/브라우저 기록
2. Pass/Fail 기록 + Fail 시 스크린샷 첨부
3. Fail 발견 시 즉시 GitHub Issue 생성
4. `TESTRUN_LOG_TEMPLATE.md`에 결과 기록

### Pass 기준

- **P0 시나리오**: 100% Pass 필수 (릴리스 차단)
- **P1 시나리오**: 90%+ Pass (릴리스 가능, 후속 패치)
- **P2 시나리오**: 참고용 (릴리스 미차단)

---

## 4. 커버리지 매핑

```
              iOS   Android   Web
A1 핵심플로우   ✅      ✅      ✅
A2 꿈기록      ✅      ✅      ✅
A3 체크인      ✅      ✅      ✅
A4 리포트      ✅      ✅      ✅
A5 설정        ✅      ✅      ✅
B1-B3 HealthKit ✅      -       -
B4-B5 HC       -       ✅      -
B6 알림        ✅      ✅      -
C1-C5 네트워크  ✅      ✅      ✅
D1-D5 생명주기  ✅      ✅      -
E1-E5 접근성    ✅      ✅      ✅
```

---

## 5. 알려진 제한사항

| 항목 | 현재 상태 | 영향 |
|------|----------|------|
| HealthKit/HC는 Mock | 실기기 권한 테스트 불가 | healthkit=false (Phase 2) |
| Playwright 미설치 | Web E2E 자동화 불가 | Phase 2 예정 |
| Appium/Detox 미구성 | 네이티브 E2E 자동화 불가 | Phase 3 예정 |
| 실기기 미보유 | 시뮬레이터/에뮬레이터만 | 베타 전 실기기 검증 필요 |
